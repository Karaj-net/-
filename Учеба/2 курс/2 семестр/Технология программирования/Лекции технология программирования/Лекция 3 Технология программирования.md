#Технология_программирования
19.02.2025

# Свойства и методы типа Charts
Рассмотрим св-ва. и методы позволяющие редактировать диаграмму:
#### Установка данных 
Для этого используется метод `SetSourseData()` аргументом является объект типа `Range` итак можно записать операторы
C:\проект\data.xlsx

|     | A       | B     | C    | D     | E    |
| --- | ------- | ----- | ---- | ----- | ---- |
| 1   |         | Весна | Лето | Осень | Зима |
| 2   | Иванов  |       |      |       |      |
| 3   | Петров  |       |      |       |      |
| 4   | Сидоров |       |      |       |      |

```c#
// ch1 and ch2 уже есть
Excel.Workbook wb1 = appE.Workbooks.Open(@"C:\проект\data.xlsx");
Excel.Range r = 
```
#### Тип диаграммы 
То есть вставляем диаграмму в лист Excel. Тип диаграммы определяется непосредственно при вставке. В случае первого варианта такой возможности, мы получим дистаграмму, чтобы установить другой тип, следует использовать св-ва. `ChartType` - это будет определять тип диаграммы
```c#
ch1.ChartType = Excel.XlChartType.xl3DColumn;
```
#### Таблица данных 
Во втором варианте у нас даны, как правило содержится на том же листе, что и диаграмма. В первом же варианте на листе диаграммы данных нет, их можно туда перенести, для этого можно записать оператор `ch1.HasDataTable = True` В результате на листе с диаграммой появятся таблица. Заметим, что при вставке каких-то объектов обычно записывается с-во., которое начинается с `Has`. Затем могут быть операторы для редактирования этого объекта

#### Вставка названия диаграммы
В начале при помощи оператора 
```c#
ch1.HasTable = True;
ch1.ChartTitle.Text = "Показатели";
ch1.ChartTitle.Font.Size = 16;
```
#### Редактирование серий
Название серии в диаграмме, в таблие и в легенде по умолчанию записывается в виде. Все они изменяются одновременно, для редактирования названия серии нужно создать коллекцию серии, для этого используется соответствующий. метод, его можно применить так:
```c#
Excel.SeriesCollection sc = ch1.SeriesCollection(); //теперь мы можем именять название серии
scItem(1).Name = "Иванов";
scItem(2).Name = "Сидаров";
scItem(3).Name = "Петров";
sc.Item(1).XlValues = {\"\Весна\",...}";
```
Мы перебираем члены коллекции и даем им названия. Можно записать название категории для этого нужному св-ву. 

#### Добавление осей
Оси создаются при помощи метода `Axis or Axes()`. Параметрами метода является тип осей и возможны три типа осей:
1) Ось значений(вертикальные) - Value;
2) Ось рядов(горизонтальные) - SeriesAxis;
3) Ось категорий(Наклонный) - Category;
Создадим оси:
```c#
Excel.Axis ox = ch1.Axes(Excel.XlAxisType.xlSeriesAxis);
Excel.Axis oy = ch1.Axes(Excel.XlAxisType.xlCategory);
Excel.Axis oz = ch1.Axes(Excel.XlAxisType.xlValue);
// дадим название осям, по анологии с нашей диаграммой
ox.HasTitle = True;
ox.AxisTitle.Text = "Времена года"
```
#### Координатная сетка
Различают толстые и тонкие линии им соответсвуют объекты:
- `MajorGridlins`
- `MinorGridlines`
По умолчанию изначально стоят толстые линии. Как обычно, чтобы установить соответствующие значения нужно использовать `Has` 
```c#
ox.HasMajorGridlines = True;
oy.HasMajorGridlines = True;
oz.HasMajorGridlines = True;
```
Установим расстояние м/у линиями, например так:
```c#
oz.MajorVnit = 2;
oz.MinorVnit = 0.5;
```