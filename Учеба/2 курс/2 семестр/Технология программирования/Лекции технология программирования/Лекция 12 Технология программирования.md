#Технология_программирования 
23.04.2025
# Прометолизоравные команды
Создадим команду для удаления данных. В начале мы будем переводить строку, без указания других операторов. Затем в конечном итоге переведем весь код к соот процедуре. Для простоты записи строку команды будем создавать в отдельном операторе предположим мы хотим удалить конкретную запись. Операторы могут иметь вид
```C#
string stz = Delete from Students where Фамилия = 'Иванов';
OledbCommand cmd2 = new OledbCommand(cnn, st2);
```

Очевидно данная команда будет удалять вполне конкретные записи, но мы должны имет возможность удалять любые записи. Для этого можно вводить фамилии в TextBox тогда командная строка примет вид
```C#
string stz = "Delete from Students where Фамилия'" + TextBox1.Text + "'";
```
Мы решили проблему, но появилась опасность в безопасности, чтобы решить проблему можно добавить строчку. В этом случае инструкция SQL примет такой вид:
```C#
string st2 = "Delete from Students where Фамилия'" + "Сидоров 'OR'A'='A" + "'";
```
Все записи из-за такой записи будут удалены. Но чтобы избежать таких случаев, можно использовать прометолизованные команды. В этой инструкции SQL можно обозначить какими-нибудь символами. Далее значение этого параметра передаем с помощью текстового поля при этом используется свойства
```C#
string str "Delete from Students where Фамилия = ?";
OledbCommand cmd2 = new OledbCommand(str, cnn);
cmd2.Parametrs.AddWithValue("Фамилия", TextBox1.Text);
```

Запишем код процедуры для удаления записи:
```C#
Void Button2.Click()
{
	try
	{
		string str "Delete from Students where Фамилия = ?";
		OledbCommand cmd2 = new OledbCommand(str, cnn);
		cmd2.Parametrs.AddWithValue("Фамилия", TextBox1.Text);
		Cnn.Open();
		int k = cmd2.ExecuteNonQueng();
		Label1.Text += String.Format("Удалено {0} записей</br>", k);
	}
	catch (Exception ex)
	{
		Label1.Text += String.Format("Ошибка[0]</br>", ex.Messege);
	}
}
```
Создадим процедуру для создания записей. Приведем командную строку и добавление параметров 
```C#
string str = "Insert into Students(Фамилия, Математика, Химия, Физика)Value(?,?,?)";
OledbCommand exd3...
cmd3.Parametrs.AddWithValue("Фамилия", TextBox1.Text);
cmd3.Parametrs.AddWithValue("Математика", IntParse(TextBox1.Text));
cmd3.Parametrs.AddWithValue("Химия", IntParse(TextBox1.Text));
cmd3.Parametrs.AddWithValue("Физика", IntParse(TextBox1.Text));
```
```C#
string str = "Update Students set Математика = ? where Фамилия = ?";
OledbCommand cmd4 = ...
cmd4.Parametrs
```

# Работа с отсоединенными наборами данных
 1. Открываем соединение
 2. Копируем данные из созданной БД
 3. Закрываем соединение
 4. Обрабатываем данные 
 5. При необходимости опять открываем соединение вносим изменения в БД и закрываем соединение

В начале рассмотрим первые три пункта. Они выполняются при помощи экземпляров класс DataAdapta. В начале надо создать экземпляр этого класса при этом используется класс с двумя параметрами значения, которые совпадают с командой select. Затем к этому экземпляру применяется метод Fill(). Этот метод имеет два параметра:
1) DataSet, который выступает в качестве контейнера, в который переносится данные из БД
2) Имя таблицы, под которой данные будут находится в DataSet

Именно при помощи метод Fill() проходят первые пункты. Итак мы получаем, что нужно в начале создать экземпляр DataSet создать экземпляр DataApdata и применит метод Fill(). Оператор может иметь вид:
```C#
DataSet ds = new DataSet();
OledbDataAdepta da = new OledbDataAdepta("Select from Students", cnn);
da.Fill(ds,"tb1");
``` мс 