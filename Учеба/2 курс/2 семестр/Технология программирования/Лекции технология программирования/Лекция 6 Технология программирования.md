#Технология_программирования 
12.03.2025
## Создание слайдов с текстом
Как уже указывалось в рассматриваемых типах слайдов всегда есть два поля. В первый мы всегда будем записывать заголовок, во втором основной текст. В это слайд запишем список студентов со стипендией, заметим, что в отличии от Word мы не можем последовательно добавлять абзацы для каждого студента, мы должны всю информацию в одну переменную, а затем поместить его содержимое во вторую область. 

Код может иметь вид:
```c#
sl = p2.Slides.Add(2, PowerPoint.PpSlidelayout.ppLayoutText);
sl.Slides[1].Text.Frame.TextRange.Text = "Список";
string s = "";
student st1 = new Student();
Excel.Application appE = new Excel.Application;
appE.Visible = True;
Excel.Workbook wb = ...;
Excel.WorkSheet ws = ...;

int k = 2;

while (ws.Cells[k, 1].Value != null){
	st1.Name = ws1.Cells[k,1].Value;
	st1.Mat = ws1.Cells[k,2].Value;
	st1.Fiz = ws1.Cells[k,3].Value;
	st1.Him = ws1.Cells[k,4].Value;
	ws2.Cells[k,1].Value = st1.Name;
	ws2.Cells[k,2].Value = st1.SrBall();
	s += ws .Cells[k, 1].Value + "          " + sb.Tostring() + "\z";
	k++;
}

sl.Shepes[2].TextFrame.TextRange.Text = s;
```

## Создание слайдов с таблицей
В этом случае в коллекцию должны вставить таблицу с помощью метода `AddTable()`. У метода `AddTable()` - два параметра кол-во столбцов и строк. Заметим, что чтобы заполнить некоторую ячейку таблицы нужно определить область этой таблицы, вставить текстовое поле и рассмотреть набор символов. Добваить строку можно, как в случае с Word 

Рассмотрим код:
```c#
sl = p2.Slides.Add(3, PowerPoint.PpSlidelayout.ppLayoutText);
sl.Slides[1].Text.Frame.TextRange.Text = "Таблица";
PowerPoint.Table t = sl.Shapes.AddTable(1, 2).Table;

//начинаем заполнять таблицу

t.Cell(1, 1).Shape.TextFrame.TextRange.Text = "Фамилия";
t.Cell(1, 2).Shape.TextFrame.TextRange.Text = "Средний балл";

int k = 2;

while (ws.Cells[k, 1].Value != null)
{
	st1.Name = ws1.Cells[k,1].Value;
	st1.Mat = ws1.Cells[k,2].Value;
	st1.Fiz = ws1.Cells[k,3].Value;
	st1.Him = ws1.Cells[k,4].Value;
	ws2.Cells[k,1].Value = st1.Name;
	ws2.Cells[k,2].Value = st1.SrBall();
	double sb = st1.SrBall();
	t.Cell(k, 1).Shape.TextFrame.TextRange.Text = ws.Cells.[k, 1].Value;
	t.Cell(k, 2).Shape.TextFrame.TextRange.Text = sb.ToSting();
	k++;
}
```

## Создание слайда с изображением
1 параметр определяет путь и название файла
2 и 3 определяет связан файл или внедрен
4 показывает расположение
5 и 6 показывают размер 

Можно внедрить для этого во втором параметре указываем ложь, а в 3 истина

Рассмотрим код:
```c#
sl = p2.Slides.Add(3, PowerPoint.PpSlidelayout.ppLayoutObject);
sl.Slides[1].Text.Frame.TextRange.Text = "Рисунок";
sl.Shapes.AddPicture(@"C:\проект\pic.png", Ms)


```

# Программирование анимации
Суть прогрммирования анимации состоит в следующем - мы разбиваем коллекцию слайдов на несколько групп, в принципе группа может быть и одна. Для каждой группы создаем объект `SlideShowTransition` для этого объекта указываем, что смена слайда будет по времени `AdvanceOnTime`. Второе, указываем время `AdvanceTime` и указываем эффект `EntryEffect` потом указываем `SlideShowTransition` Для примера приведем код, который генерирует презентацию по документу Word при этом программируется анимация с разбиением на 4 группы. НЕ ДОЛЖНО быть картинок пустых абзацев около 15 абзацев. В коде выделим части - Создание слайдов, программирование абзацев

Открываем Word и создаем презентацию

```c#
Word.Application appW = ...;
appW.Visible = ...;
Word.Document d = ...;

PowerPoint.Application appPp = ...;
appPp.Visible = 
PowerPoint.Presentation pz = ...;

PowerPoint.Slide sl = pz.Slides.Add(1, PowerPoint.PpSlidelayout.ppLayoutText);
sl.Shapes[1].Text.Frame.TextRange.Text = d.Paragraphs[1].Range.Text;
sl.Shapes[2].Text.Frame.TextRange.Text = d.Paragraphs[1].Range.Text;

int n = d.Paragraphs.Count - 1; //кол-во слайдов

for (int k = 2, k < n, k++)
{
	sl = pz.Slides.Add(k, ...);
	sl.Shapes[k].... = d.Paragraphs[k+1].Range.Text;
}

for (int i = 0; i <= (n-1)/3; i++)
{
}
```