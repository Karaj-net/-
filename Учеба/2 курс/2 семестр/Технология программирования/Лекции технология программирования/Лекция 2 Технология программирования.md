#Технология_программирования 
11.02.2025

### Класс Worksheet
Экземпляры этого класса соответствуют листам книги. 
Рассмотрим свойства:
- **Name** - как в случае книги соответствует имени листа отличием является то, что в данном случае имеется возможность изменять имя
- **Cells[i, j]** - это коллекция ячеек листа, доступ к отдельной ячейке можно получить записывая номера строк и столбцов получить доступ к содержимому ячейки используя свойство ***.Value = 4;***  
Из методов отметим **activate()** и **delete** первый активирует, второй удаляет. Совокупность листов некоторой книги образуют пространство **WorkSheets** - это коллекция состоит из ... и имеет, как обычно, метод **add()** и **count()**, как и в случае книги мы имеем 1 активный лист, с которым мы работаем в данный момент, активному листу соответствует объект **activeSheet**, заметим, что **activeSheet** является свойством самого приложения, поэтому при его использовании мы должны записать так - appE.activeSheet

Рассмотрим пример:
```C#
C:\практика\data.xlsx
```

| A   | B    | C   | D   | E   |     |
| --- | ---- | --- | --- | --- | --- |
| 1   | Имя  | Мат | Физ | Хим |     |
| 2   | Иван | 4   | 5   | 4   |     |
| 3   | Петр | 3   | 2   | 5   |     |
| 4   |      |     |     |     |     |
| 5   |      |     |     |     |     |
|     |      |     |     |     |     |
класс Student
name, mat, fiz, him - поля
Name, Mat, Fiz, Him - свойства
SrBall() - вычисление среднего балла - метод
```C#
C:\практика\data.xlsx
Excel.application appE = new Excel.application();
appE.Visible = true;

Excel.Workbook wb1 = appE.Workbooks.Open(@"C:\практика\data.xls")
Excel.Workbook wb2 = appE.Workbooks.add();
Excel.WorkSheet ws1 = wb1.WorkSheets[1];
Excel.WorkSheet ws2 = wb2.WorkSheets[1];

ws2.Cells[1,1].Value = "Фамилия";
ws2.Cells[1,2].Value = "Средний балл";
//k = номер строки
int k = 2; 
Student st1 = new Student(); //экземпляр

while (wb1.Cells[k, 1].Value != null){
st1.Name = ws1.Cells[k,1].Value;
st1.Mat = ws1.Cells[k,2].Value;
st1.Fiz = ws1.Cells[k,3].Value;
st1.Him = ws1.Cells[k,4].Value;
ws2.Cells[k,1].Value = st1.Name;
ws2.Cells[k,2].Value = st1.SrBall();
k++;
}
wb1.Close();
wb2.SaveAs(@"C:\практика\data.xlsx")
wb2.Close();
appE.Quit();
```

### Класс Range
Экземпляры, этого класса соответствуют диапозону некоторого, это может быть диапозон ячеек, диапозон строк, столбцов или отдельная ячейка. Они обозначаются так:
```C#
Range("A5 : D7")
```
Основными свойствами являются:
- **.Value()** - значение
- **.Cells[]** - колл. ячеек
- **.Rows()** - колл. строк
- **.Columns()** - колл.столбцов
- **.Formula()** - формула
**Select()** - это метод позволяет выделить некоторый диапазон, также объектами типа range являются: **Selection** - выделенная ячейка, **activeCell** - активная ячейка

```C#
Excel.application appE = new Excel.application();
appE.Visible = true;

Excel.Workbook wb = application.Open(@"C:\практика\tab.xls");
Excell.Range s = appE.Selection;

int n = s.Rows.Count;
int m = s.Columns.Count;

for (int i = 1; i <= n; i++)
	for(int j = 1; j <= m; j++)
		s.Cells[i, j].Value = i*j;
wb.Close();
appE.Ouit();
```

Поясним когда использовать соответствующие объекты активным компонентам(activeWorkbook, activeSheet, Selection, activeCell). Если пользователь желает перед выполнением программы совершить соответствующие действия с элементами Excel, например, выделить какой-то диапазон, вписать значения в ячейку, то можно использовать соответствующие методы, если такие действия не предпологаются, то лучше использовать коллекции с указанием имен нужных объектов

# Тема: Диаграммы Excel

### Вставка диаграмм
Диаграммы Excel являются экземплярами типа chart возможны 2 способа вставки диаграммы, в любом случае они создаются на основе некоторых данных, предположим, что у нас имеются на странице Excel следующая таблица:

|     | A       | B    | C     | D    | E     |
| --- | ------- | ---- | ----- | ---- | ----- |
| 1   |         | Зима | Весна | Лето | Осень |
| 2   | Иванов  | 5    | 4     | 7    | 8     |
| 3   | Петров  | 8    | 6     | 5    | 4     |
| 4   | Сидоров | 3    | 10    | 9    | 8     |
Можно выделить данные(сами числа) и выполнить оператор. В результате появится дистаграммма, которая будет расположена на отдельном листе 
```C#
appE.Charts.add();
```
Можно добавить диаграмму непосредственно на лист с данными, считаем, что данные также выделены и выполняем оператор
```C#
appE.Charts.add();

wb.WorkSheets[1].Sheps.addChart(Excel.XlTypeChart.xl.., 10, 50, 200, 300) 
//sheps - коллекция областей
```
Указанные варианты имеют ограниченные применения т.к. четко связывают расположение данных и диаграмм, а также внешний вид диаграммы, поэтому поступают несколько иным образом сначала вставляют диаграмму по умолчанию, затем выделяют объект типа chart и с помощью свойств и методов выполняют редактирование диаграммы, то есть определяют его характеристики. Рассмотрим, как получить этот объект:
1) В первом варианте - объект получается таким образом
```C#
Excel.chart ch1 = appE.Charts.add();
```
1) Во втором варианте - сначала нужно выделить объект Shape, а затем из него выделить 
```C#
	Charts Excel.Shape sp = wb.WorkSheets[1].Shapes.addChart();
	Excel.Chart ch2 = sp.Chart;
```


Дальше мы будем изучать свойства и методы типа Charts