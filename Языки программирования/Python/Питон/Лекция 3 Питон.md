#Phython
# Функции и модульность
#### 1. Функции: основные понятия и синтаксис
**Функция** - это именованный блок кода, который выполняет определенную задачу и может быть многократно вызван из разных частей программы.

**Синтаксис объявления функции:**
```python
def имя_функции(параметры):
    """Документационная строка (docstring)"""
    # Тело функции
    return результат
```

**Пример простой функции:**
```python
def calculate_sum(a, b):
    """
    Возвращает сумму двух чисел.
    
    Параметры:
        a (int/float): первое число
        b (int/float): второе число
    
    Возвращает:
        int/float: сумма a и b
    """
    result = a + b
    return result

# Вызов функции
sum_result = calculate_sum(5, 3)
print(sum_result)  # Вывод: 8
```

**Компоненты функции:**
1. `def` - ключевое слово для объявления функции
2. `calculate_sum` - имя функции (должно быть описательным)
3. `(a, b)` - параметры функции (входные данные)
4. `"""docstring"""` - документация функции (описание работы)
5. Тело функции - код, выполняющий вычисления
6. `return` - возвращает результат (если не указан, возвращает None)

#### 2. Параметры и аргументы функций
**Параметры** - переменные, указанные в объявлении функции.  
**Аргументы** - фактические значения, передаваемые при вызове.

**Типы параметров:**
1. **Позиционные параметры:**
```python
def greet(name, greeting):
    print(f"{greeting}, {name}!")
    
greet("Анна", "Привет")  # Привет, Анна!
```

2. **Параметры по умолчанию:**
```python
def power(base, exponent=2):
    return base ** exponent

print(power(3))      # 9 (используется exponent=2)
print(power(3, 4))   # 81 (explicitly set exponent=4)
```

3. **Именованные аргументы:**
```python
def create_person(name, age, city):
    return {"name": name, "age": age, "city": city}

# Порядок не важен при использовании именованных аргументов
person = create_person(age=30, city="Москва", name="Иван")
```

4. **Произвольное количество аргументов (*args и **kwargs):**
```python
# *args - кортеж позиционных аргументов
def sum_all(*numbers):
    total = 0
    for n in numbers:
        total += n
    return total

print(sum_all(1, 2, 3, 4))  # 10

# **kwargs - словарь именованных аргументов
def print_info(**details):
    for key, value in details.items():
        print(f"{key}: {value}")

print_info(name="Мария", age=25, occupation="инженер")
```

#### 3. Возвращаемые значения
Функция может возвращать любое количество значений (в виде кортежа):
```python
def min_max(numbers):
    return min(numbers), max(numbers)

nums = [4, 2, 9, 7]
min_val, max_val = min_max(nums)
print(f"Min: {min_val}, Max: {max_val}")  # Min: 2, Max: 9
```

**Особенности return:**
- После выполнения return функция немедленно завершается
- Можно возвращать разные типы данных
- Возврат нескольких значений - это кортеж

#### 4. Области видимости (Scope)
**Локальные переменные** - существуют только внутри функции.  
**Глобальные переменные** - доступны во всей программе.

```python
global_var = "Я глобальная"

def scope_demo():
    local_var = "Я локальная"
    print(global_var)  # Доступ к глобальной переменной
    print(local_var)   # Доступ к локальной переменной

scope_demo()
# print(local_var)  # Ошибка! local_var не определена вне функции
```

**Ключевое слово global:**
```python
counter = 0

def increment():
    global counter  # Объявляем, что используем глобальную переменную
    counter += 1

increment()
print(counter)  # 1
```

**Ключевое слово nonlocal (для вложенных функций):**
```python
def outer():
    x = 1
    
    def inner():
        nonlocal x  # Используем переменную из внешней функции
        x = 2
    
    inner()
    print(x)  # 2

outer()
```

#### 5. Рекурсивные функции
Функция, вызывающая саму себя. Должна иметь условие завершения!

```python
def factorial(n):
    """Вычисление факториала с помощью рекурсии"""
    if n == 0:  # Базовый случай
        return 1
    else:       # Рекурсивный случай
        return n * factorial(n-1)

print(factorial(5))  # 120
```

**Принципы рекурсии:**
1. Базовый случай (когда рекурсия останавливается)
2. Рекурсивный случай (вызов функции с измененными параметрами)
3. Движение к базовому случаю

#### 6. Lambda-функции
Анонимные функции, объявляемые с помощью ключевого слова `lambda`.

```python
# Простая lambda-функция
square = lambda x: x ** 2
print(square(5))  # 25

# Использование с map()
numbers = [1, 2, 3, 4]
squared = list(map(lambda x: x**2, numbers))
print(squared)  # [1, 4, 9, 16]

# Использование с filter()
even_numbers = list(filter(lambda x: x % 2 == 0, numbers))
print(even_numbers)  # [2, 4]
```

#### 7. Модульность в Python
**Модуль** - файл с расширением .py, содержащий код Python.

**Создание модуля:**
1. Создайте файл `math_utils.py`:
```python
# math_utils.py
PI = 3.14159

def circle_area(radius):
    return PI * radius ** 2

def rectangle_area(length, width):
    return length * width
```

2. Использование модуля:
```python
# main.py
import math_utils

print(math_utils.PI)  # 3.14159
print(math_utils.circle_area(5))  # 78.53975

# Альтернативные способы импорта
from math_utils import rectangle_area
print(rectangle_area(4, 5))  # 20

from math_utils import PI as pi_constant
print(pi_constant)  # 3.14159
```

**Пакеты** - способ организации модулей в иерархии:
```
my_package/
    __init__.py
    module1.py
    module2.py
    subpackage/
        __init__.py
        module3.py
```

**Импорт из пакетов:**
```python
from my_package import module1
from my_package.subpackage import module3
```

#### 8. Встроенные модули Python
Примеры полезных стандартных модулей:
```python
# Модуль math
import math
print(math.sqrt(25))  # 5.0
print(math.factorial(6))  # 720

# Модуль random
import random
print(random.randint(1, 100))  # Случайное число от 1 до 100
print(random.choice(["а", "б", "в"]))  # Случайный элемент списка

# Модуль datetime
from datetime import datetime, timedelta
now = datetime.now()
print(now.strftime("%d.%m.%Y %H:%M"))  # Текущая дата и время
tomorrow = now + timedelta(days=1)
```

### Домашнее задание (10 заданий)

**Задача 1: Калькулятор BMI**  
Создайте функцию `calculate_bmi(weight, height)`, возвращающую индекс массы тела. Добавьте обработку ошибок для нечисловых вводов и отрицательных значений.

**Задача 2: Рекурсивный поиск**  
Напишите рекурсивную функцию `find_index(item, sequence, start=0)`, возвращающую индекс первого вхождения элемента в последовательность или -1.

**Задача 3: Конвертер валют**  
Создайте модуль `currency_converter.py` с функцией `convert(amount, from_curr, to_curr)`, используя фиксированные курсы валют.

**Задача 4: Фильтрация данных**  
Напишите функцию `filter_data(data, condition)`, где condition - lambda-функция. Пример: `filter_data([1, 2, 3, 4], lambda x: x > 2)` → [3,4].

**Задача 5: Генератор паролей**  
Создайте функцию `generate_password(length=12, use_special=True)`, генерирующую пароль с заданными параметрами.

**Задача 6: Статистика текста**  
Напишите функцию `text_stats(text)`, возвращающую словарь с: количеством слов, букв, уникальных слов, самым частым словом.

**Задача 7: Кэширование результатов**  
Реализуйте функцию `cached(func)`, которая кэширует результаты вызовов функции и возвращает сохраненный результат при повторных вызовах с теми же аргументами.

**Задача 8: Обработка JSON**  
Создайте модуль `json_utils.py` с функциями: 
- `read_json(filename)` - чтение JSON из файла
- `write_json(data, filename)` - запись данных в JSON файл
- `filter_json(data, key, value)` - фильтрация по значению ключа

**Задача 9: Валидатор данных**  
Напишите функцию `validate_input(prompt, validator)`, где:
- `prompt` - приглашение для ввода
- `validator` - lambda-функция для проверки
Функция должна повторять ввод, пока не будет получено валидное значение.

**Задача 10: Пакет геометрических вычислений**  
Создайте пакет `geometry` с модулями:
- `circle.py`: функции area(r), circumference(r)
- `triangle.py`: area(base, height), is_right(a, b, c)
- `rectangle.py`: area(length, width), diagonal(length, width)
Напишите программу, демонстрирующую использование всех функций.

### Ресурсы для изучения
1. **[Официальная документация: функции](https://docs.python.org/3/tutorial/controlflow.html#defining-functions)**
2. **[Real Python: Functions](https://realpython.com/defining-your-own-python-function/)**
3. **[Python Modules and Packages](https://realpython.com/python-modules-packages/)**
4. **[Lambda Functions Explained](https://www.w3schools.com/python/python_lambda.asp)**
5. **[Recursion in Python](https://www.geeksforgeeks.org/recursion-in-python/)**

### Пример решения задачи 1
```python
def calculate_bmi(weight, height):
    """
    Рассчитывает индекс массы тела (BMI)
    
    Параметры:
        weight (float): вес в килограммах
        height (float): рост в метрах
    
    Возвращает:
        float: значение BMI
    """
    try:
        # Преобразование в числа с плавающей точкой
        weight = float(weight)
        height = float(height)
        
        # Проверка положительных значений
        if weight <= 0 or height <= 0:
            raise ValueError("Значения должны быть положительными")
            
        # Расчет BMI
        bmi = weight / (height ** 2)
        return round(bmi, 2)
    
    except ValueError as e:
        print(f"Ошибка ввода: {e}")
        return None
    except TypeError:
        print("Ошибка: неверный тип данных")
        return None

# Тестирование функции
print(calculate_bmi(70, 1.75))  # 22.86
print(calculate_bmi("60", "1.65"))  # 22.04
print(calculate_bmi(-70, 1.75))  # Ошибка: Значения должны быть положительными
```

### Пример решения задачи 10 (структура пакета)
```
geometry/
    __init__.py
    circle.py
    triangle.py
    rectangle.py
```

**circle.py:**
```python
PI = 3.14159

def area(radius):
    return PI * radius ** 2

def circumference(radius):
    return 2 * PI * radius
```

**main.py:**
```python
from geometry.circle import area as circle_area
from geometry.triangle import area as triangle_area

print(circle_area(5))
print(triangle_area(4, 3))
```